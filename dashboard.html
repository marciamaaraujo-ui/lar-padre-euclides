<!DOCTYPE html>
<html lang="pt-br">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Dashboard ILPI</title>
<link rel="stylesheet" href="style.css">
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>

<body onload="renderizarDashboard()">

    <!-- NAVBAR INSTITUCIONAL -->
<div class="navbar">
    <div class="nav-container">

        <div class="nav-left">
            <img src="assets/logo.png" class="nav-logo" alt="Logo ILPI">
        </div>

        <div class="nav-links">
            <a href="index.html">ğŸ  InÃ­cio</a>
            <a href="ficha-completa.html">ğŸ“‹ AvaliaÃ§Ã£o Completa</a>
            <a href="dashboard.html">ğŸ“Š Dashboard</a>

            <div id="indicadorRisco" class="indicador-risco neutro">
                ICN: â€”
            </div>

            <button class="btn-navbar" onclick="salvarRegistro()">ğŸ’¾ Salvar</button>
        </div>

    </div>
</div>
  
<div class="container">
<div class="navbar">
<div class="nav-container">
<img src="assets/logo.png" class="nav-logo">
<div class="nav-links">
<a href="index.html" class="nav-link">ğŸ  Nova AvaliaÃ§Ã£o</a>
<a href="dashboard.html" class="nav-link home-btn">ğŸ“Š Dashboard</a>
<a href="ficha-completa.html" class="nav-link">ğŸ“‚ Ficha ClÃ­nica</a>
<a href="exames-laboratoriais.html" class="nav-link">ğŸ§ª Exames</a>
<a href="comorbidades.html" class="nav-link">ğŸ¥ Comorbidades</a>
<a href="metodologia.html" class="nav-link">ğŸ“˜ Metodologia</a>
</div>
</div>
</div>

<div class="container">
<h1>Painel EpidemiolÃ³gico</h1>

<section style="margin-top:40px;">
<h3>Top 5 Comorbidades</h3>
<canvas id="graficoComorb"></canvas>
</section>

</div>

<script>

function renderizarDashboard(){

const banco = JSON.parse(localStorage.getItem("bancoILPI")) || {};
let contagem={};

Object.keys(banco).forEach(nome=>{
(banco[nome].comorbidades||[]).forEach(c=>{
contagem[c]=(contagem[c]||0)+1;
});
});

const top=Object.entries(contagem)
.sort((a,b)=>b[1]-a[1])
.slice(0,5);

new Chart(document.getElementById("graficoComorb"),{
type:"bar",
data:{
labels:top.map(i=>i[0]),
datasets:[{
label:"NÂº de Residentes",
data:top.map(i=>i[1])
}]
}
});
}

</script>
</body>
</html>
